# Temperature-Controlled Fan

    This project uses a wheatstone bridge, an INA122 instrumentation amplifier, a PIC16F18324 8-bit microcontroller, a heater, and a fan to build an intelligent fan controller that varies the speed of the fan relative to the temperature. The wheatstone bridge was connected to the INA122 amplifier (as shown in the diagram) to design a circuit that converts temperature - from the thermistor on the wheatstone bridge - to a variable DC voltage. The output voltage of the circuit is captured by the PIC via an analog pin. The analog value is used to determine the duty cycle of the pulse width modulator (PWM), which is connected to the fan in order to control its speed. The heater is connected to a power supply and used to heat up the thermistor to test the changes in fan speed.
 
    The software is written in C and used to control the PIC microcontroller. A timer register (TMR0) is enabled and set to run the interrupt every 10 milliseconds by setting the prescaler rate to 1:64 and, therefore, the TMR0 period register to 155. Pin 3 of the PIC (RA4) is configured as an analog input in order to receive the voltage. The voltage is then converted into a digital binary value and stored in the ADRESH register. Pin 5 (RC5) is configured as an output for the post width modulation and a second timer (TMR2) is enabled for the PWM clock. The required interrupts are enabled via their respective registers as well.
 
    The fan starts by going full speed for three seconds by giving the PWM5DCH register a max value of 255 which sets the duty cycle to 100%. If statements are used to change the duty cycle based on the value of the ADRESH register that stores the binary value of the analog conversion. The value used to compare to the ADRESH value calculated using the formula (255*V)/5. If the ADRESH value is less than the calculated value, then the duty cycle gets set by writing to the PWM5DCH register. As the temperature increases, so does the the ADRESH  registerâ€™s value which, in turn, causes the duty cycle to increase as well. The duty cycle starts at around 30% and increments up to 100% between 120 and 130 degrees fahrenheit. The value that gets written to the PWM5DHC register is calculated by DutyCycle*255.
